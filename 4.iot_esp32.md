ตัวอย่างโค้ดเบื้องต้นในการใช้งานบอร์ด **ESP32** ด้วย Arduino IDE

---

## 1. เตรียม Arduino IDE

1. **ติดตั้ง Arduino IDE**  
   - ดาวน์โหลดได้จาก [Arduino Software](https://www.arduino.cc/en/software) (เลือกเวอร์ชันที่เหมาะสมกับระบบปฏิบัติการ)

2. **เพิ่มบอร์ด ESP32 ลงใน Arduino IDE**  
   - ไปที่ **File** > **Preferences** (หรือ Arduino IDE > Preferences ใน macOS)
   - ในช่อง **Additional Boards Manager URLs** ให้ใส่ลิงก์:  
     ```
     https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json
     ```
     (ถ้ามีหลายลิงก์ให้ใช้เครื่องหมายจุลภาค `,` คั่น)
   - ไปที่ **Tools** > **Board** > **Boards Manager...**
   - พิมพ์คำว่า “esp32” ในช่องค้นหา แล้วกดติดตั้ง “esp32 by Espressif Systems”

3. **เลือกบอร์ด ESP32**  
   - ไปที่ **Tools** > **Board** > เลือกหมวด “ESP32 Arduino” แล้วเลือกชื่อบอร์ดที่ตรงกับโมดูลของเรา (เช่น “ESP32 Dev Module”)

4. **เลือกพอร์ต (Port)**  
   - เสียบสาย USB เข้ากับคอมพิวเตอร์
   - ไปที่ **Tools** > **Port** แล้วเลือกพอร์ตที่ปรากฏ (เช่น COM3, COM4 ใน Windows หรือ /dev/cu.usbserial ใน macOS)

---

## 2. โค้ดตัวอย่าง: กระพริบ LED (Blink)

บอร์ด ESP32 DevKit ส่วนใหญ่จะมี LED ติดตั้งบนบอร์ด (มักเชื่อมต่ออยู่ที่ขา **GPIO2** หรือบางรุ่นอาจเป็น GPIO อื่น)  
หากบอร์ดรุ่นที่ใช้อาจไม่มี LED on-board (หรือไม่ได้เชื่อมต่อ GPIO2 เป็น LED) สามารถต่อ LED ภายนอกพร้อมรีซิสเตอร์ แล้วเปลี่ยนหมายเลขพินตามจริงได้

```cpp
// โค้ดตัวอย่าง Blink LED บน ESP32

// กำหนดหมายเลขพินที่เชื่อมต่อกับ LED on-board
// บางรุ่นอาจใช้ pin 2 หรือ pin 5 หรือ pin 4 แล้วแต่รุ่น
#define LED_PIN 2

void setup() {
  // ตั้งค่าพินเป็นโหมด OUTPUT
  pinMode(LED_PIN, OUTPUT);
}

void loop() {
  digitalWrite(LED_PIN, HIGH); // เปิด LED
  delay(1000);                 // หน่วงเวลา 1 วินาที (1000 ms)
  digitalWrite(LED_PIN, LOW);  // ปิด LED
  delay(1000);                 // หน่วงเวลา 1 วินาที
}
```
 
- `pinMode(LED_PIN, OUTPUT);` : ตั้งค่าขา GPIO ที่เลือกให้เป็นขา Output เพื่อควบคุม LED  
- `digitalWrite(LED_PIN, HIGH);` : จ่ายไฟระดับสูง (3.3V) เพื่อให้ LED ติด  
- `delay(1000);` : หน่วงเวลา 1000 มิลลิวินาที (1 วินาที)  
- `digitalWrite(LED_PIN, LOW);` : จ่ายไฟระดับต่ำ (0V) เพื่อให้ LED ดับ  
- `delay(1000);` : หน่วงเวลาอีก 1 วินาที  

หลังจากอัปโหลดโค้ดลงบอร์ด หากเชื่อมพิน LED ถูกต้อง LED จะกระพริบทุก 1 วินาที

---

## 3. โค้ดตัวอย่าง: สแกนหาเครือข่าย Wi-Fi

ESP32 มีโมดูล Wi-Fi ในตัว สามารถเขียนโค้ดเพื่อสแกนหาเครือข่ายรอบ ๆ ได้ ตัวอย่างดังนี้

```cpp
#include "WiFi.h" // ไลบรารีสำหรับการใช้งาน Wi-Fi บน ESP32

void setup() {
  Serial.begin(115200);
  Serial.println("Setup WiFi scan ...");

  // ไม่ต้องตั้งค่าโหมด STA ก็ได้ (ESP32 จะเป็น STA เองโดยเริ่มต้น)
  // แต่เพื่อความชัดเจน เราสามารถระบุได้ว่าใช้โหมด STA (Station)
  WiFi.mode(WIFI_STA);
  WiFi.disconnect(); // ยกเลิกการเชื่อมต่อเก่า หากมี
  delay(100);
}

void loop() {
  Serial.println("เริ่มสแกน Wi-Fi ...");
  
  int numberOfNetworks = WiFi.scanNetworks(); // สแกนหาเครือข่าย
  Serial.println("การสแกนเสร็จสิ้น");
  
  if(numberOfNetworks == 0) {
    Serial.println("ไม่พบ Wi-Fi ใด ๆ");
  } else {
    Serial.print("พบเครือข่ายทั้งหมด: ");
    Serial.println(numberOfNetworks);
    
    for(int i = 0; i < numberOfNetworks; i++) {
      // แสดงชื่อเครือข่าย (SSID), ความแรงของสัญญาณ (RSSI) และบอกว่ามีการเข้ารหัสหรือไม่
      Serial.print(i + 1);
      Serial.print(": ");
      Serial.print(WiFi.SSID(i));
      Serial.print(" (RSSI: ");
      Serial.print(WiFi.RSSI(i));
      Serial.print(")");
      Serial.print(" | Encryption: ");
      Serial.println((WiFi.encryptionType(i) == WIFI_AUTH_OPEN) ? "Open" : "Protected");
      delay(10);
    }
  }
  
  Serial.println("");
  // สแกนเสร็จแล้วหน่วงเวลา 5 วินาทีค่อยสแกนซ้ำ
  delay(5000);
}
```

**ทดไว้**  
- `#include "WiFi.h"` : ไลบรารีสำหรับจัดการ Wi-Fi ใน ESP32  
- `WiFi.mode(WIFI_STA);` : ตั้งค่าโหมดเป็น Station (โหมดเชื่อมต่อกับ Access Point อื่น)  
- `WiFi.disconnect();` : ตัดการเชื่อมต่อก่อน เพื่อให้การสแกนไม่ติดค้างโหมดเก่า  
- `WiFi.scanNetworks();` : สแกนหา AP (Access Point) รอบ ๆ  
- วนลูปแสดงรายละเอียด SSID, ความแรงสัญญาณ RSSI, และประเภทการเข้ารหัส  
- หน่วงเวลา 5 วินาทีแล้วค่อยสแกนใหม่วนไปเรื่อย ๆ ในฟังก์ชัน `loop()`  

เมื่ออัปโหลดโค้ดและเปิด Serial Monitor (ปรับ Baud rate เป็น 115200) จะเห็นผลลัพธ์ของเครือข่ายแสดงในคอนโซล

---

## 4. โค้ดตัวอย่าง: เชื่อมต่อ Wi-Fi และดู IP Address

เมื่อทราบ SSID และรหัสผ่านแล้ว สามารถเชื่อมต่อและแสดง IP Address ได้ดังนี้

```cpp
#include "WiFi.h"

const char* ssid     = "YOUR_SSID";      // เปลี่ยนเป็นชื่อ Wi-Fi ของคุณ
const char* password = "YOUR_PASSWORD";  // เปลี่ยนเป็นรหัสผ่าน Wi-Fi ของคุณ

void setup() {
  Serial.begin(115200);
  Serial.println();
  Serial.println("เชื่อมต่อ Wi-Fi");

  // ตั้งโหมดเป็น Station
  WiFi.mode(WIFI_STA);
  // เริ่มเชื่อมต่อ
  WiFi.begin(ssid, password);

  // รอจนกว่าจะเชื่อมต่อได้
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }
  
  Serial.println("");
  Serial.println("เชื่อมต่อสำเร็จ!");
  Serial.print("IP Address: ");
  Serial.println(WiFi.localIP());
}

void loop() {
  // ยังไม่ทำอะไรเพิ่มเติมในส่วนนี้
}
```

**ทดไว้**  
- ใส่ SSID และ Password ให้ตรงกับ Wi-Fi ที่ต้องการเชื่อมต่อ  
- `WiFi.begin(ssid, password);` สั่งเชื่อมต่อ  
- ใน `while (WiFi.status() != WL_CONNECTED) {...}` จะคอยตรวจสอบสถานะว่ายังไม่เชื่อมต่อก็หน่วงเล็กน้อยแล้วลองเช็คซ้ำ  
- เมื่อเชื่อมต่อได้จะแสดง IP Address ของ ESP32 ผ่าน Serial Monitor  

---

## 5. การเชื่อมต่อเซนเซอร์ DHT11 กับ ESP32

> **หมายเหตุ**: DHT11 สามารถจ่ายไฟได้ตั้งแต่ 3.3V ถึง 5V  
> สำหรับ ESP32 ควรใช้แรงดัน **3.3V** เพื่อให้สัญญาณอินพุตที่ขา GPIO สอดคล้องกัน

1. **ขา VCC ของ DHT11** ต่อกับ **3.3V** ของ ESP32  
2. **ขา GND ของ DHT11** ต่อกับ **GND** ของ ESP32  
3. **ขา DATA ของ DHT11** (มักเป็นขากลางหรือขาที่ 2) ต่อกับ **GPIO บน ESP32** เช่น GPIO4 หรือ GPIO15 เป็นต้น  
4. ควรมี **ตัวต้านทาน 10kΩ (pull-up resistor)** ระหว่างขา DATA กับ VCC เพื่อให้สัญญาณนิ่งขึ้น (แม้บางโมดูล DHT11 จะมีการติดตั้งตัวต้านทานนี้มาแล้วบนบอร์ด)

ผังการต่อสาย (ตัวอย่างเลือก GPIO4):

```
ESP32 3.3V   --->  VCC (DHT11)
ESP32 GND    --->  GND (DHT11)
ESP32 GPIO4  --->  DATA (DHT11)
             -->  ตัวต้านทาน 10kΩ ดึงจาก DATA ไป 3.3V
```

เพื่อให้ใช้งาน DHT11 (หรือ DHT22) ได้สะดวก ควรติดตั้งไลบรารี **DHT sensor library** โดย Adafruit หรือจะใช้ไลบรารี **DHTesp** ก็ได้ วิธีติดตั้งมีดังนี้

1. เปิด Arduino IDE
2. ไปที่ **Tools** > **Manage Libraries...** (Library Manager)
3. ในช่องค้นหา พิมพ์ “DHT” 
4. เลือกติดตั้ง **“DHT sensor library by Adafruit”** (หรือหากชอบไลบรารีอื่นเช่น “DHTesp” ก็สามารถใช้ได้เช่นกัน)

สำหรับโค้ดตัวอย่างในที่นี้ จะใช้ **Adafruit DHT sensor library**

---

## 7. โค้ดตัวอย่าง (Adafruit DHT Library)

ตัวอย่างนี้สมมติว่าเชื่อมต่อขา DATA ของ DHT11 ไปที่ **GPIO4** ของ ESP32

```cpp
#include <DHT.h>

// กำหนดพินที่เชื่อมต่อเซนเซอร์ DHT11
#define DHTPIN 4

// หากเป็น DHT22 ให้เปลี่ยนเป็น DHT22
#define DHTTYPE DHT11

// สร้างอ็อบเจ็กต์ DHT (อ้างอิงไลบรารี Adafruit)
DHT dht(DHTPIN, DHTTYPE);

void setup() {
  Serial.begin(115200);
  Serial.println();
  Serial.println("เริ่มต้นการอ่านข้อมูลจาก DHT11...");

  // เริ่มต้นเซนเซอร์
  dht.begin();
}

void loop() {
  // อ่านค่าความชื้น (Humidity)
  float humidity = dht.readHumidity();
  // อ่านค่าอุณหภูมิ (Temperature) หน่วยองศาเซลเซียส
  float temperature = dht.readTemperature();

  // ตรวจสอบว่าการอ่านค่าสำเร็จหรือไม่ (หากล้มเหลวจะได้ NaN)
  if (isnan(humidity) || isnan(temperature)) {
    Serial.println("ไม่สามารถอ่านค่าจาก DHT11 ได้!");
  } else {
    Serial.print("ความชื้น: ");
    Serial.print(humidity);
    Serial.print(" %\t");

    Serial.print("อุณหภูมิ: ");
    Serial.print(temperature);
    Serial.println(" °C");
  }

  // หน่วงเวลา 2 วินาที (2000 ms) ก่อนอ่านค่าใหม่
  delay(2000);
}
```

**ทดไว้** 
1. `#include <DHT.h>` : เรียกใช้งานไลบรารี Adafruit DHT  
2. `#define DHTPIN 4` : ระบุว่า DHT11 ต่ออยู่ที่ขา GPIO4 ของ ESP32  
3. `#define DHTTYPE DHT11` : เลือกชนิดของ DHT เป็น DHT11 (หากใช้ DHT22 เปลี่ยนเป็น DHT22)  
4. `DHT dht(DHTPIN, DHTTYPE);` : สร้างอ็อบเจ็กต์ DHT เพื่อใช้เมธอด `readHumidity()` และ `readTemperature()`  
5. ใน `setup()` : เรียก `dht.begin()` เพื่อเริ่มต้นเซนเซอร์  
6. ใน `loop()` : 
   - `dht.readHumidity()` อ่านค่าความชื้น (หน่วย %)  
   - `dht.readTemperature()` อ่านค่าอุณหภูมิ (หน่วย °C โดยดีฟอลต์)  
   - ตรวจเช็คหากเป็น `NaN` แสดงว่าอ่านค่าไม่สำเร็จ  
   - พิมพ์ค่าออกทาง `Serial`  
   - `delay(2000)` หน่วง 2 วินาที แล้วค่อยวนอ่านใหม่

---